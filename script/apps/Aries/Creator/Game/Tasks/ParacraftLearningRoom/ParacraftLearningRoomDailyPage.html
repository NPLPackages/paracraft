<!-- "script/apps/Aries/Creator/Game/Tasks/ParacraftLearningRoom/ParacraftLearningRoomDailyPage.html" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>
<body>
<pe:mcml>
<script refresh="true" type="text/npl" src="ParacraftLearningRoomDailyPage.lua"><![CDATA[
local KeepWorkItemManager = NPL.load("(gl)script/apps/Aries/Creator/HttpAPI/KeepWorkItemManager.lua");
local ParacraftLearningRoomDailyPage = NPL.load("(gl)script/apps/Aries/Creator/Game/Tasks/ParacraftLearningRoom/ParacraftLearningRoomDailyPage.lua");
ParacraftLearningRoomDailyPage.OnInit()
function ClosePage()
    Page:CloseWindow();
end
function DS_Items(index)
    if(index == nil) then
        return #ParacraftLearningRoomDailyPage.Current_Item_DS;
    else
        return ParacraftLearningRoomDailyPage.Current_Item_DS[index];
    end
end

function IsNextDay(index)
    return ParacraftLearningRoomDailyPage.IsNextDay(index);
end

function IsFuture(index)
    return ParacraftLearningRoomDailyPage.IsFuture(index);
end

function HasCheckedToday()
    return ParacraftLearningRoomDailyPage.HasCheckedToday();
end
function SaveToLocal()
    ParacraftLearningRoomDailyPage.SaveToLocal();
end
function OnCheck()
    ParacraftLearningRoomDailyPage.OnCheck();
end
function OnOpenWeb(index)
	ParacraftLearningRoomDailyPage.ClosePage();
    ParacraftLearningRoomDailyPage.OnOpenWeb(index,true);
end

function OnOpenWebExchange()
    ParaGlobal.ShellExecute("open", "explorer.exe", "https://keepwork.com/", "", 1); 
end
function OnVIP()
    ParacraftLearningRoomDailyPage.OnVIP()
end

function GetTip()
    local gsid = 998;
    local template = KeepWorkItemManager.GetItemTemplate(gsid);
    local s = string.format(L"点击下方[签到]按钮完成今日签到，每日可按顺序签到一次并获得4个%s，签到成功后可观看当日学习视频。可以点击列表项目重复观看已签到视频，VIP用户可提前观看未签到视频。",template.name);
    return s;
end
function GetExchangePoints()
    local gsid = 998;
    local template = KeepWorkItemManager.GetItemTemplate(gsid);
    local bHas,guid,bagid,copies = KeepWorkItemManager.HasGSItem(gsid)
    copies = copies or 0;
    local s = string.format("%s:%d",template.name, copies);
    return s;
end
function GetDays()
    local copies = ParacraftLearningRoomDailyPage.copies or 0;
    local s = string.format(L"已完成:%d天",copies);
    return s;
end
function GetLabel(index)
    local s = string.format(L"视频%s",tostring(index));
    return s;
end
function OnCheckinToday()
    ParacraftLearningRoomDailyPage.OnCheckinToday();
end
]]></script>
    <aries:window mode="thin" width="600" height="500" title='<%= L"每日签到：《高手成长日记》"%>' onclose="ClosePage">
    <div >
        <div style="height:120px;">
            <div style="margin-top:20px;color:#ffffff;"><%= GetTip() %></div>
            <div style="margin-left:380px;margin-top:20px;">
                <div style="float:left;margin-top:2px;width:20px;height:20px;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/points_32bits.png#0 0 20 20);"></div>
                <div style="float:left;margin-left:2px;color:#ffffff;"><%=GetExchangePoints()%></div>
                <!--<div style="float:left;margin-left:10px;margin-top:-5px;"><input type="button"  value='<%=L"积分兑换"%>' style="width:85px;height:30px;color:#ffffff;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/blue_bg_32bits.png:6 6 6 6);" onclick="OnOpenWebExchange" /></div>-->
            </div>
            
        </div>
        <div style="margin-left:-4px;width:598px;height:50px;color:#ffffff;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/gray_bg_32bits.png:6 6 6 6);" >
            <div style="margin-top:15px;">
                <div style="float:left;width:300px;padding-left:10px;">
                    <%=GetDays()%>
                </div>
                <div style="float:left;">
                    <div style="float:left;margin-top:5px;width:18px;height:18px;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/checked_32bits.png#0 0 18 18);"></div>
                    <div style="float:left;margin-left:5px;">已完成</div>
                    <div style="float:left;margin-left:5px;">|</div>
                    <div style="float:left;margin-left:5px;margin-top:2px;width:20px;height:20px;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/vip_32bits.png#0 0 20 20);"></div>
                    <div style="float:left;margin-left:5px;">VIP可看</div>
                    <div style="float:left;margin-left:10px;margin-top:-5px;"><input type="button"  value='<%=L"开通VIP"%>' style="width:85px;height:30px;color:#ffffff;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/orange_bg_32bits.png:6 6 6 6);" onclick="OnVIP" /></div>
                </div>
            </div>
            
        </div>
        <div style="margin-top:0px;">
            <pe:gridview style="margin:0px;width:600px;height:400px;" name="item_gridview" CellPadding="15" VerticalScrollBarStep="36" VerticalScrollBarOffsetX="8" AllowPaging="false" ItemsPerLine="7" DefaultNodeHeight = "68" 
                DataSource='<%=DS_Items%>'>
	            <Columns>
                            <div style="width:60px;height:80px;">

                                <pe:if condition='<%= IsFuture(Eval("index")) %>'>
                                    <input type="button" name='<%= Eval("index")%>' style="width:70px;height:60px;color:#ffffff;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/play_gray_32bits.png#0 0 70 60);" onclick="OnOpenWeb"  />
                                    <div style="position:relative;margin-left:-5px;width:70px;height:60px;color:#ffffff;">
                                        <div style="text-align:center;">
                                             <%= GetLabel(Eval("index"))%>
                                        </div>
                                    </div>
                                </pe:if>
                                <pe:if condition='<%= not IsFuture(Eval("index")) %>'>
                                    <pe:if condition='<%= IsNextDay(Eval("index")) %>'>
                                        <pe:if condition='<%= HasCheckedToday(Eval("index")) %>'>
                                            <input type="button" name='<%= Eval("index")%>' style="width:70px;height:60px;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/play_orange_32bits.png#0 0 70 60);" onclick="OnOpenWeb"  />
                                            <div style="position:relative;margin-left:-5px;margin-top:1px;width:70px;height:60px;color:#ffffff;">
                                                <div style="text-align:center;">
                                                    <%= L"签到成功" %>
                                                </div>
                                            </div>
                                            
                                        </pe:if>
                                        <pe:if condition='<%= not HasCheckedToday(Eval("index")) %>'>
                                           <input type="button" name='<%= Eval("index")%>' style="width:70px;height:60px;color:#e67300;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/play_yellow_32bits.png#0 0 70 60);" onclick="OnCheckinToday"  />
                                            <div style="position:relative;margin-left:-5px;margin-top:1px;width:70px;height:60px;color:#ffffff;">
                                                <div zorder="101" style="margin-top:0px;text-align:center;">
                                                    <%= L"点击签到" %>
                                                </div>
                                            </div>
                                            <!--fire practices-->
                                            <div style="position:relative;margin-left:-5px;margin-top:-70px;width:70px;height:70px;background:" >
                                                <img uiname="checkin_animator" zorder="100" enabled="false" class="animated_btn_overlay" width="70" height="70"/>
                                            </div>     
                                        </pe:if>
                                    </pe:if>
                                    <pe:if condition='<%= not IsNextDay(Eval("index")) %>'>
                                        <input type="button" name='<%= Eval("index")%>' style="width:70px;height:61px;color:#ffffff;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/play_green_32bits.png#0 0 70 60);" onclick="OnOpenWeb"  />
                                         <div style="position:relative;margin-left:-5px;width:70px;height:60px;color:#ffffff;">
                                            <div style="text-align:center;">
                                                <%= GetLabel(Eval("index"))%>
                                            </div>
                                        </div>
                                    </pe:if>
                                </pe:if>
                                
                            </div>
                            
                </Columns>
	            <EmptyDataTemplate>
	            </EmptyDataTemplate>
            </pe:gridview>
        </div>
    </div>
    
</aries:window>
</pe:mcml>
</body>
</html>

